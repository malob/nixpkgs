# Claude Code Configuration

This directory contains my [Claude Code](https://claude.ai/code) configuration files.

## How It Works

These files are symlinked into `~/.claude/` by [Home Manager](https://github.com/nix-community/home-manager) using `mkOutOfStoreSymlink`. This means:

- Files can be edited in place without rebuilding the Nix configuration
- Changes take effect immediately (or on next Claude Code session)
- Everything stays version-controlled in this repo

The symlinks are set up in [`home/claude.nix`](../../home/claude.nix).

## Directory Structure

| Path          | Description                                      |
| ------------- | ------------------------------------------------ |
| `CLAUDE.md`   | Global instructions loaded in every session      |
| `mcp.json`    | MCP server configuration                         |
| `commands/`   | Custom slash commands                            |
| `agents/`     | Custom agent definitions                         |
| `skills/`     | Custom skills                                    |
| `rules/`      | Custom rules                                     |
| `hooks/`      | Global hooks (PostToolUse, etc.)                 |
| `plugins/`    | Personal plugin marketplace (see `plugins/README.md`) |

## What's NOT Here

**`settings.json`** is generated by Nix rather than symlinked. This is because it contains machine-specific paths that need to be interpolated at build time (e.g., the path to the plugins marketplace). To modify settings like permissions or enabled plugins, edit `home/claude.nix` and rebuild.

## The Home Manager Module

The [`home/claude.nix`](../../home/claude.nix) module:

1. Wraps `claude-code` to include `--mcp-config` pointing to the symlinked `mcp.json`
2. Generates `settings.json` with interpolated paths for the current machine
3. Symlinks everything else from this directory into `~/.claude/`
4. Sets up a shell alias for 1Password integration (if enabled)
